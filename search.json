[{"path":"https://heavywatal.github.io/tekkamaki/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2017 Watal M. Iwasaki Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/articles/snp.html","id":"generate-a-gene-genealogy","dir":"Articles","previous_headings":"","what":"Generate a gene genealogy","title":"Simulate SNP pattern","text":"","code":"set.seed(666L) result = tekka(\"-y40 -K1000 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] genealogy = make_gene_genealogy(samples) |> print() ## $V  tibble [722 × 1] (S3: tbl_df/tbl/data.frame) ##  $ name: chr [1:722] \"211-1\" \"5-1\" \"192-1\" \"5-2\" ... ## # A tibble: 720 × 4 ##    from  to    birth_year capture_year ##    <chr> <chr>      <int>        <int> ##  1 211-1 5-1           40           40 ##  2 192-1 5-2           40           40 ##  3 242-2 6-1           40           40 ##  4 219-2 6-2           40           40 ##  5 322-1 13-1          40           40 ##  6 314-1 13-2          40           40 ##  7 342-2 14-1          40           40 ##  8 337-1 14-2          40           40 ##  9 87-2  1-1           39           39 ## 10 17-1  1-2           39           39 ## # ℹ 710 more rows"},{"path":"https://heavywatal.github.io/tekkamaki/articles/snp.html","id":"visualize-the-generated-gene-genealogy","dir":"Articles","previous_headings":"","what":"Visualize the generated gene genealogy","title":"Simulate SNP pattern","text":"","code":"plot(genealogy) +   theme_void() +   theme_palette +   theme(legend.position = \"top\")"},{"path":"https://heavywatal.github.io/tekkamaki/articles/snp.html","id":"generate-snps","dir":"Articles","previous_headings":"","what":"Generate SNPs","title":"Simulate SNP pattern","text":"Randomly place fixed number mutations given genealogy without recombination. Save SNP patterns VCF file: can also generate list SNP data.frame chromosomes recombination parallel. Use RNGkind(\"L'Ecuyer-CMRG\") set.seed() reproducibility:","code":"snp = place_mutations(genealogy, 3L) |> print() ##            ## 5-1  0 0 0 ## 5-2  0 0 0 ## 6-1  0 0 0 ## 6-2  0 0 0 ## 13-1 1 0 0 ## 13-2 0 1 0 ## 14-1 0 0 0 ## 14-2 0 0 0 ## 1-1  0 0 0 ## 1-2  0 0 0 ## 2-1  0 0 0 ## 2-2  0 0 0 ## 9-1  0 0 0 ## 9-2  0 0 0 ## 10-1 0 0 0 ## 10-2 0 0 0 ## 7-1  0 0 0 ## 7-2  0 0 0 ## 8-1  0 0 0 ## 8-2  0 0 0 ## 3-1  0 0 1 ## 3-2  0 0 0 ## 4-1  0 0 0 ## 4-2  0 0 0 ## 12-1 0 0 0 ## 12-2 0 0 0 ## 15-1 0 0 0 ## 15-2 0 0 0 ## 16-1 0 0 0 ## 16-2 0 0 0 ## 11-1 0 0 0 ## 11-2 0 0 0 write_vcf(snp, some_file) ## ##fileformat=VCFv4.5 ## #CHROM   POS ID  REF ALT QUAL    FILTER  INFO    FORMAT  5   6   13  14  1   2   9   10  7   8   3   4   12  15  16  11 ## .    .   .   .   .   .   .   .   GT  0|0 0|0 1|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 ## .    .   .   .   .   .   .   .   GT  0|0 0|0 0|1 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 ## .    .   .   .   .   .   .   .   GT  0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 1|0 0|0 0|0 0|0 0|0 0|0 options(mc.cores = 2L) # parallel::detectCores(logical = FALSE) RNGkind(\"L'Ecuyer-CMRG\") set.seed(666L) snp = make_snp(samples, ss = c(chr7 = 4L, chr8 = 3L)) vcf = as_vcf(snp) |> add_pos_id() write_vcf(vcf, some_file) ## ##fileformat=VCFv4.5 ## #CHROM   POS ID  REF ALT QUAL    FILTER  INFO    FORMAT  5   6   13  14  1   2   9   10  7   8   3   4   12  15  16  11 ## chr7 1   chr7-1  .   .   .   .   .   GT  0|0 0|0 0|0 0|0 0|0 0|1 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 ## chr7 2   chr7-2  .   .   .   .   .   GT  0|0 0|0 0|0 0|0 0|0 0|1 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 ## chr7 3   chr7-3  .   .   .   .   .   GT  0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|1 ## chr7 4   chr7-4  .   .   .   .   .   GT  0|0 0|0 0|0 0|0 0|0 0|0 1|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 ## chr8 1   chr8-1  .   .   .   .   .   GT  0|0 0|1 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 ## chr8 2   chr8-2  .   .   .   .   .   GT  0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 1|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 ## chr8 3   chr8-3  .   .   .   .   .   GT  0|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0 1|0 0|0 0|0 0|0 0|0 0|0 0|0 0|0"},{"path":"https://heavywatal.github.io/tekkamaki/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Watal M. Iwasaki. Author, maintainer.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Iwasaki W (2025). tekkamaki: Individual-based simulator pacific bluefin tuna. R package version 0.9.0, https://heavywatal.github.io/tekkamaki/.","code":"@Manual{,   title = {tekkamaki: Individual-based simulator of pacific bluefin tuna},   author = {Watal M. Iwasaki},   year = {2025},   note = {R package version 0.9.0},   url = {https://heavywatal.github.io/tekkamaki/}, }"},{"path":"https://heavywatal.github.io/tekkamaki/index.html","id":"tekkamaki-","dir":"","previous_headings":"","what":"Individual-based simulator of pacific bluefin tuna","title":"Individual-based simulator of pacific bluefin tuna","text":"R interface tekka.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/index.html","id":"requirements","dir":"","previous_headings":"","what":"Requirements","title":"Individual-based simulator of pacific bluefin tuna","text":"Unix-like OS (macOS, Linux, etc.) C++17 compiler (clang++ >= Apple clang 11.0, g++ >= 9.1) CMake","code":""},{"path":"https://heavywatal.github.io/tekkamaki/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Individual-based simulator of pacific bluefin tuna","text":"code tries find use installed tekka system. old found, latest version installed. use bleeding edge (HEAD) specific revision, set environment variable TEKKA_GIT_TAG installation: installation tekka tekkamaki can checked following commands: Please include information report issues.","code":"# install.packages(\"pak\") pak::pak(\"heavywatal/tekkamaki\") Sys.setenv(TEKKA_GIT_TAG = \"HEAD\") tekkamaki::tekka_path() tekkamaki::tekka_version() sessioninfo::session_info(\"tekkamaki\")"},{"path":"https://heavywatal.github.io/tekkamaki/reference/genealogy.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate gene genealogy from samples — make_gene_genealogy","title":"Generate gene genealogy from samples — make_gene_genealogy","text":"individual-based family tree stored sample_family transformed gene-based table gather_segments(). , ancestry gene/segment randomly assigned make_gene_genealogy(). Sampled segments ancestors can annotated annotate_sampled().","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/genealogy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate gene genealogy from samples — make_gene_genealogy","text":"","code":"make_gene_genealogy(samples)  gather_segments(samples)  count_uncoalesced(genealogy)  annotate_sampled(genealogy)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/genealogy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate gene genealogy from samples — make_gene_genealogy","text":"samples data.frame: sample_family transformation gather_segments(). Using latter improve performance function called many times, e.g., make_snp(). genealogy output make_gene_genealogy().","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/genealogy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate gene genealogy from samples — make_gene_genealogy","text":"igraphlite object genealogy subclass. gather_segments() transforms individual-based sample_family segment-based table. count_uncoalesced() returns count uncoalesced roots genealogy. annotate_sampled() adds \"sampled\" edge attribute genealogy: TRUE sampled, FALSE upstream samples, NA unrelated.","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/genealogy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate gene genealogy from samples — make_gene_genealogy","text":"","code":"set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] segments = gather_segments(samples) segments #> # A tibble: 220 × 4 #>    id    birth_year capture_year parent_id #>    <chr>      <int>        <int>     <int> #>  1 5-1           25           25        71 #>  2 5-2           25           25        66 #>  3 6-1           25           25        75 #>  4 6-2           25           25        72 #>  5 13-1          25           25        15 #>  6 13-2          25           25        97 #>  7 14-1          25           25        15 #>  8 14-2          25           25       100 #>  9 1-1           24           24        43 #> 10 1-2           24           24        17 #> # ℹ 210 more rows  genealogy = make_gene_genealogy(segments) genealogy #> $V  tibble [222 × 1] (S3: tbl_df/tbl/data.frame) #>  $ name: chr [1:222] \"71-1\" \"5-1\" \"66-1\" \"5-2\" ... #> # A tibble: 220 × 4 #>    from  to    birth_year capture_year #>    <chr> <chr>      <int>        <int> #>  1 71-1  5-1           25           25 #>  2 66-1  5-2           25           25 #>  3 75-2  6-1           25           25 #>  4 72-2  6-2           25           25 #>  5 15-1  13-1          25           25 #>  6 97-1  13-2          25           25 #>  7 15-2  14-1          25           25 #>  8 100-1 14-2          25           25 #>  9 43-2  1-1           24           24 #> 10 17-1  1-2           24           24 #> # ℹ 210 more rows  count_uncoalesced(genealogy) #> [1] 13  annotate_sampled(genealogy) #> $V  tibble [222 × 1] (S3: tbl_df/tbl/data.frame) #>  $ name: chr [1:222] \"71-1\" \"5-1\" \"66-1\" \"5-2\" ... #> # A tibble: 220 × 5 #>    from  to    birth_year capture_year sampled #>    <chr> <chr>      <int>        <int> <lgl>   #>  1 71-1  5-1           25           25 TRUE    #>  2 66-1  5-2           25           25 TRUE    #>  3 75-2  6-1           25           25 TRUE    #>  4 72-2  6-2           25           25 TRUE    #>  5 15-1  13-1          25           25 TRUE    #>  6 97-1  13-2          25           25 TRUE    #>  7 15-2  14-1          25           25 TRUE    #>  8 100-1 14-2          25           25 TRUE    #>  9 43-2  1-1           24           24 TRUE    #> 10 17-1  1-2           24           24 TRUE    #> # ℹ 210 more rows"},{"path":"https://heavywatal.github.io/tekkamaki/reference/graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert sample family data.frames to igraphlight objects — as_igraph.sample_family","title":"Convert sample family data.frames to igraphlight objects — as_igraph.sample_family","text":"Connections among samples ancestors recorded sample_family data.frames. as_igraph() converts igraphlite objects.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert sample family data.frames to igraphlight objects — as_igraph.sample_family","text":"","code":"# S3 method for class 'sample_family' as_igraph(x, ...)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert sample family data.frames to igraphlight objects — as_igraph.sample_family","text":"x sample_family data.frame output tekka(). ... Additional arguments passed igraphlite::graph_from_data_frame().","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/graph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert sample family data.frames to igraphlight objects — as_igraph.sample_family","text":"","code":"set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] as_igraph(samples) #> $V  tibble [112 × 1] (S3: tbl_df/tbl/data.frame) #>  $ name: int [1:112] 0 22 21 23 20 25 26 24 19 29 ... #> # A tibble: 222 × 2 #>     from    to #>    <int> <int> #>  1     0    22 #>  2     0    22 #>  3    22    21 #>  4    22    21 #>  5    22    23 #>  6    22    23 #>  7    21    20 #>  8    23    20 #>  9    22    25 #> 10    22    25 #> # ℹ 212 more rows"},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp.html","id":null,"dir":"Reference","previous_headings":"","what":"Count half-sib pairs in HSP format — as_hsp","title":"Count half-sib pairs in HSP format — as_hsp","text":"Half-sib pairs counted samples grouped birth year sampled location.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count half-sib pairs in HSP format — as_hsp","text":"","code":"as_hsp(samples)  write_hsp(x, path = \"hsp.txt\")  read_hsp(path)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count half-sib pairs in HSP format — as_hsp","text":"samples sample_family data.frame tekka() result. x outcome as_hsp() path file name connection write ","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count half-sib pairs in HSP format — as_hsp","text":"data.frame \"hsp\" subclass six columns: cohort_i, cohort_j: birth year samples location_i, location_j: sampling comps: number possible comparisons group j. samples compared pairwise, excluding self-comparisons. total number comparisons equals \\(n \\choose 2\\), n total sample size. hsps: count half-sib pairs observed group j","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Count half-sib pairs in HSP format — as_hsp","text":"as_hsp() converts result data frame HSP format. write_hsp() writes HSP data.frame file.","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count half-sib pairs in HSP format — as_hsp","text":"","code":"set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] as_hsp(samples) #> # A tibble: 45 × 6 #>    cohort_i cohort_j location_i location_j comps  hsps #>       <int>    <int>      <int>      <int> <int> <int> #>  1       14       15          1          1     1     1 #>  2       20       20          0          0     3     1 #>  3       24       24          1          1     1     1 #>  4       24       25          0          1     4     2 #>  5       25       25          1          1     1     1 #>  6       14       14          1          1     0     0 #>  7       14       18          1          1     2     0 #>  8       14       20          1          0     3     0 #>  9       14       21          1          0     1     0 #> 10       14       24          1          0     2     0 #> # ℹ 35 more rows"},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp2.html","id":null,"dir":"Reference","previous_headings":"","what":"Count half-sib pairs in HSP2 format — as_hsp2","title":"Count half-sib pairs in HSP2 format — as_hsp2","text":"extended version HSP format additional columns grouping.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count half-sib pairs in HSP2 format — as_hsp2","text":"","code":"as_hsp2(samples)  write_hsp2(x, path = \"hsp2.tsv\")  read_hsp2(path)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count half-sib pairs in HSP2 format — as_hsp2","text":"samples sample_family data.frame tekka() result. x outcome as_hsp2(). path file name connection write .","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count half-sib pairs in HSP2 format — as_hsp2","text":"data.frame \"hsp2\" subclass following columns: cohort_i, cohort_j: birth year samples capture_age_i, capture_age_j: samples location_i, location_j: sampling comps: number possible comparisons group j. samples compared pairwise, excluding self-comparisons. total number comparisons equals \\(n \\choose 2\\), n total sample size. hsps: count half-sib pairs observed group j","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/hsp2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count half-sib pairs in HSP2 format — as_hsp2","text":"","code":"set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] as_hsp2(samples) #> # A tibble: 55 × 8 #>    cohort_i cohort_j capture_age_i capture_age_j location_i location_j comps #>       <int>    <int>         <int>         <int>      <int>      <int> <int> #>  1       14       15            10             9          1          1     1 #>  2       20       20             4             5          0          0     2 #>  3       24       24             0             0          1          1     1 #>  4       24       25             0             0          0          1     4 #>  5       25       25             0             0          1          1     1 #>  6       14       14            10            10          1          1     0 #>  7       14       18            10             7          1          1     2 #>  8       14       20            10             4          1          0     2 #>  9       14       20            10             5          1          0     1 #> 10       14       21            10             4          1          0     1 #> # ℹ 45 more rows #> # ℹ 1 more variable: hsps <int>"},{"path":"https://heavywatal.github.io/tekkamaki/reference/kinship.html","id":null,"dir":"Reference","previous_headings":"","what":"Analyze kinship within samples — find_kinship","title":"Analyze kinship within samples — find_kinship","text":"Analyze kinship within samples","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/kinship.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analyze kinship within samples — find_kinship","text":"","code":"find_kinship(samples, order = 4L, experimental = FALSE)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/kinship.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analyze kinship within samples — find_kinship","text":"samples sample_family order integer experimental boolean","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/kinship.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analyze kinship within samples — find_kinship","text":"data.frame following columns: , : sample IDs integer. path: text representation path found samples; ascending 1 descending 0; count paths indicated _n suffix; e.g., \"10_1\" \"10_2\" means half-sibling full-sibling pairs, respectively. degree: number steps path. label: aliases path. See https://github.com/heavywatal/tekkamaki/blob/main/data-raw/kinlabels.R available labels.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/kinship.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Analyze kinship within samples — find_kinship","text":"find_kinship() finds kinship given order.","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/kinship.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Analyze kinship within samples — find_kinship","text":"","code":"set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] find_kinship(samples, order = 3L) #> # A tibble: 17 × 5 #>     from    to path  degree label #>    <int> <int> <chr>  <int> <fct> #>  1     2    13 10_1       2 HS    #>  2     2    14 10_1       2 HS    #>  3     2    15 1_1        1 PO    #>  4     3     5 100_1      3 HUN   #>  5     4     7 10_1       2 HS    #>  6     9    10 10_1       2 HS    #>  7     9    11 1_1        1 PO    #>  8     9    14 100_1      3 HUN   #>  9    11    14 00_1       2 GG    #> 10    12     5 00_1       2 GG    #> 11    12     6 00_1       2 GG    #> 12    12     9 100_1      3 HUN   #> 13    12    11 10_1       2 HS    #> 14    13    14 10_1       2 HS    #> 15    13    16 110_1      3 HUN   #> 16    15    13 0_1        1 PO    #> 17    15    14 0_1        1 PO"},{"path":"https://heavywatal.github.io/tekkamaki/reference/parameter.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize parameter json file — plot_parameters_json","title":"Visualize parameter json file — plot_parameters_json","text":"Visualize parameter json file","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/parameter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize parameter json file — plot_parameters_json","text":"","code":"plot_parameters_json(obj = default_parameters_json())"},{"path":"https://heavywatal.github.io/tekkamaki/reference/parameter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize parameter json file — plot_parameters_json","text":"obj jsonlite object","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/parameter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize parameter json file — plot_parameters_json","text":"","code":"plot_parameters_json()"},{"path":"https://heavywatal.github.io/tekkamaki/reference/path.html","id":null,"dir":"Reference","previous_headings":"","what":"Get information about the tekka executable — tekka_path","title":"Get information about the tekka executable — tekka_path","text":"simulator tekka command-line tool written C++. executable built installed along R package unless pre-installed one found package installation.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get information about the tekka executable — tekka_path","text":"","code":"tekka_path()  tekka_version()"},{"path":"https://heavywatal.github.io/tekkamaki/reference/path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get information about the tekka executable — tekka_path","text":"tekka_path() returns path tekka executable. tekka_version() returns version tekka executable.","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/path.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get information about the tekka executable — tekka_path","text":"","code":"if (FALSE) { # \\dontrun{ tekka_path()  tekka_version() } # }"},{"path":"https://heavywatal.github.io/tekkamaki/reference/plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for quick visualization — augment.sample_family","title":"Methods for quick visualization — augment.sample_family","text":"Sample family trees generated gene genealogies can visualized briefly plot() method. output can customized ggplot2 functions. input can also customized. First, use augment() add coordinates attributes plotting. can modify needed. Finally, build plot ggplot2::ggplot().","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for quick visualization — augment.sample_family","text":"","code":"# S3 method for class 'sample_family' augment(x, layout = NULL, ...)  # S3 method for class 'genealogy' augment(x, layout = NULL, ...)  layout_demography(x)  # S3 method for class 'genealogy' plot(x, ..., lwd = 0.5, cex = 5, pch = 16)  # S3 method for class 'sample_family' plot(x, ..., lwd = 0.5, cex = 5, pch = 16)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for quick visualization — augment.sample_family","text":"x sample_family genealogy data.frame. layout data.frame function compute coordinates. layout_demography() applied default. ... Additional arguments passed layout function. lwd passed ggplot2::geom_segment. cex, pch passed ggplot2::geom_point ggplot2::geom_text.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for quick visualization — augment.sample_family","text":"augment() returns data.frame suitable plotting. layout_demography() computes coordinates plotting genealogy. plot() returns ggplot2 object.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Methods for quick visualization — augment.sample_family","text":"","code":"set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] augment(samples) #> # A tibble: 222 × 10 #>     from    to birth_year capture_year sampled     x     y  xend  yend label #>    <int> <int>      <int>        <int> <lgl>   <int> <int> <int> <int> <int> #>  1    17     1         24           24 TRUE        1    24     1    19     1 #>  2    43     1         24           24 TRUE        1    24     2    19     1 #>  3    57     2         24           24 TRUE        2    24     3    19     2 #>  4    15     2         24           24 TRUE        2    24     1    18     2 #>  5    59     3         20           24 TRUE        1    20     3    10     3 #>  6    60     3         20           24 TRUE        1    20     2    13     3 #>  7    63     4         20           24 TRUE        2    20     2    15     4 #>  8    65     4         20           24 TRUE        2    20     3    15     4 #>  9    66     5         25           25 TRUE        1    25     4    20     5 #> 10    71     5         25           25 TRUE        1    25     2    21     5 #> # ℹ 212 more rows  plot(samples) +   ggplot2::theme_void() +   ggplot2::theme(legend.position = \"top\")   genealogy = make_gene_genealogy(samples) plot(genealogy) +   ggplot2::theme_void() +   ggplot2::theme(legend.position = \"top\")"},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop.html","id":null,"dir":"Reference","previous_headings":"","what":"Count parent-offspring pairs in POP format — as_pop","title":"Count parent-offspring pairs in POP format — as_pop","text":"Parent-offspring pairs counted potential offspring cohort potential parents grouped age, year, location sampling.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count parent-offspring pairs in POP format — as_pop","text":"","code":"as_pop(samples)  write_pop(x, path = \"pop.txt\")  read_pop(path)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count parent-offspring pairs in POP format — as_pop","text":"samples sample_family data.frame tekka() result. x outcome as_pop() path file name connection write ","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count parent-offspring pairs in POP format — as_pop","text":"data.frame \"pop\" subclass six columns: cohort: birth year offspring capture_year: parents capture_age: parents location: parents sampled pops: count parent-offspring pairs observed within samples comps: number possible comparisons, including pairs one sample younger .","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Count parent-offspring pairs in POP format — as_pop","text":"as_pop() converts sample_family data frame POP format. write_pop() writes POP data.frame file.","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count parent-offspring pairs in POP format — as_pop","text":"","code":"set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] as_pop(samples) #> # A tibble: 25 × 6 #>    cohort capture_year capture_age location  pops comps #>     <int>        <int>       <int>    <int> <int> <int> #>  1     24           24          10        1     1     4 #>  2     24           25           7        1     1     8 #>  3     25           25           7        1     2     8 #>  4     15           24          10        1     0     1 #>  5     18           24           9        1     0     2 #>  6     18           24          10        1     0     2 #>  7     20           24           9        1     0     3 #>  8     20           24          10        1     0     3 #>  9     20           25           7        1     0     6 #> 10     21           24           4        0     0     2 #> # ℹ 15 more rows"},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop2.html","id":null,"dir":"Reference","previous_headings":"","what":"Count parent-offspring pairs in POP2 format — as_pop2","title":"Count parent-offspring pairs in POP2 format — as_pop2","text":"extended version POP format additional columns grouping.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count parent-offspring pairs in POP2 format — as_pop2","text":"","code":"as_pop2(samples)  write_pop2(x, path = \"pop2.tsv\")  read_pop2(path)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count parent-offspring pairs in POP2 format — as_pop2","text":"samples sample_family data.frame tekka() result. x outcome as_pop2() path file name connection write .","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count parent-offspring pairs in POP2 format — as_pop2","text":"data.frame \"pop2\" subclass following columns: cohort_parent, cohort_offspring: birth year samples capture_age_parent, capture_age_offspring location_parent, location_offspring: sampling pops: count parent-offspring pairs observed within samples comps: number possible comparisons, including pairs one sample younger .","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/pop2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count parent-offspring pairs in POP2 format — as_pop2","text":"","code":"set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] as_pop2(samples) #> # A tibble: 42 × 8 #>    cohort_parent cohort_offspring capture_age_parent capture_age_offspring #>            <int>            <int>              <int>                 <int> #>  1            14               24                 10                     0 #>  2            18               24                  7                     0 #>  3            18               25                  7                     0 #>  4            14               15                 10                     9 #>  5            14               18                 10                     7 #>  6            14               20                 10                     4 #>  7            14               20                 10                     5 #>  8            14               21                 10                     4 #>  9            14               24                 10                     0 #> 10            14               25                 10                     0 #> # ℹ 32 more rows #> # ℹ 4 more variables: location_parent <int>, location_offspring <int>, #> #   pops <int>, comps <int>"},{"path":"https://heavywatal.github.io/tekkamaki/reference/read.html","id":null,"dir":"Reference","previous_headings":"","what":"Read results from tekka — read_tekka","title":"Read results from tekka — read_tekka","text":"tekka simulator writes results configuration files directory. function reads one-row data.frame.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/read.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read results from tekka — read_tekka","text":"","code":"read_tekka(indir = getwd())"},{"path":"https://heavywatal.github.io/tekkamaki/reference/read.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read results from tekka — read_tekka","text":"indir output directory tekka.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/read.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read results from tekka — read_tekka","text":"one-row data.frame configuration parameters results. two result columns: sample_family: list data.frames samples ancestors. demography: list data.frames population demography.","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. generics augment igraphlite as_igraph","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/sampled.html","id":null,"dir":"Reference","previous_headings":"","what":"Count actually sampled individuals — count_sampled","title":"Count actually sampled individuals — count_sampled","text":"Count actually sampled individuals","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/sampled.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count actually sampled individuals — count_sampled","text":"","code":"count_sampled(samples)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/sampled.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count actually sampled individuals — count_sampled","text":"samples sample_family data.frame tekka() result.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/sampled.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count actually sampled individuals — count_sampled","text":"data.frame following columns: capture_year location adult juvenile","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/sampled.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count actually sampled individuals — count_sampled","text":"","code":"set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] count_sampled(samples) #> # A tibble: 4 × 4 #>   capture_year location adult juvenile #>          <int>    <int> <int>    <int> #> 1           24        0     2        2 #> 2           24        1     2        2 #> 3           25        0     2        2 #> 4           25        1     2        2"},{"path":"https://heavywatal.github.io/tekkamaki/reference/snp.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate SNPs on given samples. — make_snp","title":"Generate SNPs on given samples. — make_snp","text":"place_mutations() generates SNP data.frame randomly placing fixed number mutations given genealogy. means sites perfectly linked . make_snp_chromosome() simulates SNP data.frame chromosome using place_mutations() recombination. make_snp() calls chromosome parallel. Use RNGkind(\"L'Ecuyer-CMRG\") set.seed() get reproducible results. number CPU cores used can configured via mc.cores option.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/snp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate SNPs on given samples. — make_snp","text":"","code":"make_snp(samples, ss)  make_snp_chromosome(genealogy, segsites)  place_mutations(genealogy, segsites, v_sampled = NULL)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/snp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate SNPs on given samples. — make_snp","text":"samples data.frame: sample_family transformation gather_segments(). Using latter improve performance function called many times, e.g., make_snp(). ss sequence segsites; length number chromosome; element number segsites chromosome. named vector given, output also named. genealogy output make_gene_genealogy(). segsites number segregating sites segment. v_sampled sampled vertices. Use fix output order.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/snp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate SNPs on given samples. — make_snp","text":"make_snp() returns list data.frame chromosome. make_snp_chromosome() place_mutations() returns data.frame segregating sites columns, sample segments rows.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/snp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate SNPs on given samples. — make_snp","text":"assumed node genealogy one recombination event chromosome. words, chromosome fixed number recombination events, equal number nodes genealogy. locations randomly assigned, segregating sites placed among . example, chromosome 3 segsites genealogy 10 nodes can illustrated like : 5' rrrSrrSrrrrSr 3'.","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/snp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate SNPs on given samples. — make_snp","text":"","code":"RNGkind(\"L'Ecuyer-CMRG\") set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] segments = gather_segments(samples) genealogy = make_gene_genealogy(segments)  place_mutations(genealogy, 3L) |> str() #> 'data.frame':\t32 obs. of  3 variables: #>  $ : int  0 0 0 0 0 0 0 0 0 0 ... #>  $ : int  0 0 0 0 0 0 0 0 0 0 ... #>  $ : int  0 0 0 0 0 0 0 0 0 0 ...  ss = c(chr1 = 3, chr2 = 2) make_snp(segments, ss) |> str() #> List of 2 #>  $ chr1:'data.frame':\t32 obs. of  3 variables: #>   ..$ : int [1:32] 0 0 0 0 0 0 0 1 0 0 ... #>   ..$ : int [1:32] 0 0 0 0 0 0 0 0 0 0 ... #>   ..$ : int [1:32] 0 0 0 0 0 0 0 0 0 0 ... #>  $ chr2:'data.frame':\t32 obs. of  2 variables: #>   ..$ : int [1:32] 1 0 0 0 0 0 0 0 0 0 ... #>   ..$ : int [1:32] 0 0 0 0 0 0 0 0 0 0 ..."},{"path":"https://heavywatal.github.io/tekkamaki/reference/tekka.html","id":null,"dir":"Reference","previous_headings":"","what":"Run the tekka simulator. — tekka","title":"Run the tekka simulator. — tekka","text":"result first written directory cache, read data.frame. previous result exactly arguments found cache, read without calling tekka.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/tekka.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run the tekka simulator. — tekka","text":"","code":"tekka(args = character(0L), cache = NULL)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/tekka.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run the tekka simulator. — tekka","text":"args Command line arguments string vector. See tekka manual tekka(\"--help\") available options. Note random --seed appended given. Use set.seed() --seed explicitly reproducibility caching. cache Parent directory tekka output. TRUE equivalent \".\" (current directory). tempdir() used cases including default (NULL), discarded end R session. Set FALSE force tekka run overwrite previous results .","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/tekka.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run the tekka simulator. — tekka","text":"data.frame read read_tekka().","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/tekka.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run the tekka simulator. — tekka","text":"","code":"set.seed(666) # tekka(\"--help\")  result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") result |> dplyr::select(!\"outdir\") #> # A tibble: 1 × 16 #>   carrying_capacity fishing_coef fishing_mortality  last migration_matrices #>               <dbl> <list>       <list>            <int> <list>             #> 1              2000 <list [0]>   <dbl [84]>            2 <dbl [9 × 4 × 4]>  #> # ℹ 11 more variables: natural_mortality <list>, origin <int>, #> #   overdispersion <dbl>, recruitment <dbl>, sample_size_adult <list>, #> #   sample_size_juvenile <list>, seed <int>, weight_for_age <list>, #> #   years <int>, sample_family <list>, demography <list>  result$sample_family[[1L]] #> # A tibble: 150 × 6 #>       id father_id mother_id birth_year location capture_year #>    <int>     <int>     <int>      <int>    <int>        <int> #>  1    21         0         0         -4       NA           NA #>  2    20        21        21          0       NA           NA #>  3    22        21        21          0       NA           NA #>  4    19        20        22          7       NA           NA #>  5    24        21        21          0       NA           NA #>  6    25        21        21          0       NA           NA #>  7    23        24        25          4       NA           NA #>  8    18        19        23         13       NA           NA #>  9    28        21        21          0       NA           NA #> 10    27        20        28          7       NA           NA #> # ℹ 140 more rows  result$demography[[1L]] #> # A tibble: 1,300 × 5 #>     year season location   age count #>    <int>  <int>    <int> <int> <int> #>  1     0      0        0     0  2000 #>  2     0      1        0     0  1227 #>  3     0      2        0     0   787 #>  4     0      3        0     0   469 #>  5     4      0        0     0  2036 #>  6     4      0        0     4    24 #>  7     4      1        0     0  1284 #>  8     4      1        0     4    20 #>  9     4      2        0     0   817 #> 10     4      2        0     4    18 #> # ℹ 1,290 more rows"},{"path":"https://heavywatal.github.io/tekkamaki/reference/tekkamaki-package.html","id":null,"dir":"Reference","previous_headings":"","what":"tekkamaki: Individual-based simulator of pacific bluefin tuna — tekkamaki-package","title":"tekkamaki: Individual-based simulator of pacific bluefin tuna — tekkamaki-package","text":"Individual-based simulator pacific bluefin tuna.","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/tekkamaki-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"tekkamaki: Individual-based simulator of pacific bluefin tuna — tekkamaki-package","text":"Maintainer: Watal M. Iwasaki heavywatal@gmail.com (ORCID)","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/vcf.html","id":null,"dir":"Reference","previous_headings":"","what":"Utilities for VCF format — as_vcf","title":"Utilities for VCF format — as_vcf","text":"as_vcf() converts SNP data.frame generated make_snp() VCF-like data.frame. \"CHROM\", \"FORMAT\", \"gt\" columns filled. add_pos_id() useful fill \"POS\" \"ID\" columns. assigns sequential integers \"POS\" column \"CHROM\", combines \"CHROM\" make unique \"ID\" values. write_vcf() read_vcf() used write read VCF files. SNP data.frame given, converted writing.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/vcf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utilities for VCF format — as_vcf","text":"","code":"as_vcf(x, phased = TRUE, chrom = NA_character_, pos = NA_integer_)  add_pos_id(x)  write_vcf(x, file)  read_vcf(file)  as_vcf_gt(x, phased = TRUE)"},{"path":"https://heavywatal.github.io/tekkamaki/reference/vcf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Utilities for VCF format — as_vcf","text":"x SNP data.frame VCF data.frame. phased logical switch separators: | vs /. chrom Characters. pos Integers. file path connection.","code":""},{"path":"https://heavywatal.github.io/tekkamaki/reference/vcf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Utilities for VCF format — as_vcf","text":"VCF-like data.frame \"vcf\" subclass. as_vcf_gt() returns single-column data.frame \"vcf_gt\" subclass.","code":""},{"path":[]},{"path":"https://heavywatal.github.io/tekkamaki/reference/vcf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Utilities for VCF format — as_vcf","text":"","code":"RNGkind(\"L'Ecuyer-CMRG\") set.seed(666) result = tekka(\"-y25 -l2 --sa 2,2 --sj 2,2\") samples = result$sample_family[[1L]] ss = c(chr1 = 3, chr2 = 2) snp = make_snp(samples, ss) vcf = as_vcf(snp) |> add_pos_id() vcf #> # A tibble: 5 × 10 #>   CHROM   POS ID     REF   ALT   QUAL  FILTER INFO  FORMAT gt                    #>   <chr> <int> <chr>  <chr> <chr> <chr> <chr>  <chr> <chr>  <chr>                 #> 1 chr1      1 chr1-1 NA    NA    NA    NA     NA    GT     \"0|0\\t0|0\\t0|0\\t1|0\\… #> 2 chr1      2 chr1-2 NA    NA    NA    NA     NA    GT     \"0|0\\t0|0\\t0|0\\t0|0\\… #> 3 chr1      3 chr1-3 NA    NA    NA    NA     NA    GT     \"0|0\\t0|0\\t0|0\\t0|0\\… #> 4 chr2      1 chr2-1 NA    NA    NA    NA     NA    GT     \"0|0\\t0|0\\t0|0\\t0|0\\… #> 5 chr2      2 chr2-2 NA    NA    NA    NA     NA    GT     \"0|0\\t0|0\\t0|1\\t0|0\\…"}]
